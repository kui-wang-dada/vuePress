<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>设计模式：把不变的事物和变化的事物分离开来 | 哒哒的博客</title>
    <meta name="description" content="哒哒练习写文章做记录的地方">
    <link rel="icon" href="/blog/img/logo.png">
    
    <link rel="preload" href="/blog/assets/css/0.styles.1846c831.css" as="style"><link rel="preload" href="/blog/assets/js/app.0d710046.js" as="script"><link rel="preload" href="/blog/assets/js/2.3724615d.js" as="script"><link rel="preload" href="/blog/assets/js/9.39b50577.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.b61dd10e.js"><link rel="prefetch" href="/blog/assets/js/11.e5fbb993.js"><link rel="prefetch" href="/blog/assets/js/12.6072f3fe.js"><link rel="prefetch" href="/blog/assets/js/13.119ec9f1.js"><link rel="prefetch" href="/blog/assets/js/14.50793965.js"><link rel="prefetch" href="/blog/assets/js/15.6b54485c.js"><link rel="prefetch" href="/blog/assets/js/16.31f68c05.js"><link rel="prefetch" href="/blog/assets/js/17.4e4585ba.js"><link rel="prefetch" href="/blog/assets/js/18.68501181.js"><link rel="prefetch" href="/blog/assets/js/19.0e5b6c69.js"><link rel="prefetch" href="/blog/assets/js/20.d751fd77.js"><link rel="prefetch" href="/blog/assets/js/21.61020ecb.js"><link rel="prefetch" href="/blog/assets/js/22.6843e775.js"><link rel="prefetch" href="/blog/assets/js/23.c4fe93cf.js"><link rel="prefetch" href="/blog/assets/js/24.92a8097d.js"><link rel="prefetch" href="/blog/assets/js/25.a3f181ca.js"><link rel="prefetch" href="/blog/assets/js/26.244f0e68.js"><link rel="prefetch" href="/blog/assets/js/27.87040a01.js"><link rel="prefetch" href="/blog/assets/js/28.1ce7f872.js"><link rel="prefetch" href="/blog/assets/js/29.a62422be.js"><link rel="prefetch" href="/blog/assets/js/3.e00b5bcc.js"><link rel="prefetch" href="/blog/assets/js/4.15bd42cb.js"><link rel="prefetch" href="/blog/assets/js/5.37f72eb9.js"><link rel="prefetch" href="/blog/assets/js/6.f95e396f.js"><link rel="prefetch" href="/blog/assets/js/7.3e10e91f.js"><link rel="prefetch" href="/blog/assets/js/8.853705b0.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.1846c831.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">哒哒的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JS/object.html" class="nav-link">JS之面向对象程序设计和继承</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/base.html" class="nav-link">JS基础知识总结</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/copy.html" class="nav-link">JS深浅拷贝</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/design.html" class="nav-link router-link-exact-active router-link-active">JS设计模式</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/this.html" class="nav-link">JS之this指向</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/ifelse.html" class="nav-link">JS条件语句</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/simple.html" class="nav-link">JS之代码简洁之道</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ReactNative</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ReactNative/summary.html" class="nav-link">ReactNative技术栈总结</a></li><li class="dropdown-item"><!----> <a href="/blog/ReactNative/record.html" class="nav-link">ReactNative知识点记录</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Vue/base.html" class="nav-link">vue基础知识</a></li><li class="dropdown-item"><!----> <a href="/blog/Vue/vuex.html" class="nav-link">vuex基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">混合开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/hybird/cordova.html" class="nav-link">cordova基础</a></li><li class="dropdown-item"><!----> <a href="/blog/hybird/vueCordova.html" class="nav-link">vue+cordova思考</a></li><li class="dropdown-item"><!----> <a href="/blog/hybird/uniapp.html" class="nav-link">小程序多端框架研究</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Node/koa2.html" class="nav-link">koa2+sequelize初探</a></li><li class="dropdown-item"><!----> <a href="/blog/Node/fullStack.html" class="nav-link">全栈工程思考</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/http/base.html" class="nav-link">http协议总结</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">构建</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/goujian/webpack.html" class="nav-link">webpack学习</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JS/object.html" class="nav-link">JS之面向对象程序设计和继承</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/base.html" class="nav-link">JS基础知识总结</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/copy.html" class="nav-link">JS深浅拷贝</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/design.html" class="nav-link router-link-exact-active router-link-active">JS设计模式</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/this.html" class="nav-link">JS之this指向</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/ifelse.html" class="nav-link">JS条件语句</a></li><li class="dropdown-item"><!----> <a href="/blog/JS/simple.html" class="nav-link">JS之代码简洁之道</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ReactNative</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ReactNative/summary.html" class="nav-link">ReactNative技术栈总结</a></li><li class="dropdown-item"><!----> <a href="/blog/ReactNative/record.html" class="nav-link">ReactNative知识点记录</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Vue/base.html" class="nav-link">vue基础知识</a></li><li class="dropdown-item"><!----> <a href="/blog/Vue/vuex.html" class="nav-link">vuex基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">混合开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/hybird/cordova.html" class="nav-link">cordova基础</a></li><li class="dropdown-item"><!----> <a href="/blog/hybird/vueCordova.html" class="nav-link">vue+cordova思考</a></li><li class="dropdown-item"><!----> <a href="/blog/hybird/uniapp.html" class="nav-link">小程序多端框架研究</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Node/koa2.html" class="nav-link">koa2+sequelize初探</a></li><li class="dropdown-item"><!----> <a href="/blog/Node/fullStack.html" class="nav-link">全栈工程思考</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/http/base.html" class="nav-link">http协议总结</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">构建</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/goujian/webpack.html" class="nav-link">webpack学习</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>设计模式：把不变的事物和变化的事物分离开来</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/JS/design.html#单例模式" class="sidebar-link">单例模式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/JS/design.html#策略模式" class="sidebar-link">策略模式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/JS/design.html#代理模式" class="sidebar-link">代理模式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/JS/design.html#迭代器模式" class="sidebar-link">迭代器模式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/JS/design.html#发布订阅模式-观察者模式" class="sidebar-link">发布订阅模式-观察者模式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/JS/design.html#命令模式" class="sidebar-link">命令模式</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="设计模式：把不变的事物和变化的事物分离开来"><a href="#设计模式：把不变的事物和变化的事物分离开来" aria-hidden="true" class="header-anchor">#</a> 设计模式：把不变的事物和变化的事物分离开来</h1> <h2 id="单例模式"><a href="#单例模式" aria-hidden="true" class="header-anchor">#</a> 单例模式</h2> <p>保证一个类只有一个实例，并提供一个访问它的全局访问点</p> <p>用一个变量来标志当前是否已经为某个类创建过对象，如果是，则在下一次获取该类的实例时，直接返回之前创建的对象。</p> <p>javascript中的单例模式</p> <p>建一个全局变量，就是单例</p> <p>确保只有一个实例，并提供全局访问</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>缺点</p> <p>命名空间污染</p> <p>使用 命名空间</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> namespace<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token function-variable function">a</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token function-variable function">b</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用闭包封装私有变量</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//自执行函数</span>
<span class="token comment">//返回一个对象，对象的属性为一个方法</span>

<span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> _name <span class="token operator">=</span> <span class="token string">'wang'</span>
    <span class="token keyword">var</span> _age <span class="token operator">=</span> <span class="token number">12</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">getUserInfo</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> _name<span class="token operator">+</span>_age
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="策略模式"><a href="#策略模式" aria-hidden="true" class="header-anchor">#</a> 策略模式</h2> <p>定义一系列的算法，吧他们各自封装成策略类，算法被封装在策略类内部的方法里。在客户对Context发起请求的时候，Context总是把请求委托给这些策略对象中间的某一个进行计算</p> <p>eg</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">calcu</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">level<span class="token punctuation">,</span>salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>level<span class="token operator">===</span><span class="token string">'s'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary<span class="token operator">*</span><span class="token number">4</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>level<span class="token operator">===</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary<span class="token operator">*</span><span class="token number">3</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>level<span class="token operator">===</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary<span class="token operator">*</span><span class="token number">2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">calcu</span><span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token number">20000</span><span class="token punctuation">)</span>
</code></pre></div><p>优缺点：</p> <ul><li>代码简单</li> <li>calcu函数庞大，包含很多if-else语句，这些语句需要覆盖所有的逻辑分支</li> <li>函数缺乏弹性，违反开放-封闭原则</li> <li>复用性差</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//定义策略类</span>
<span class="token keyword">var</span> strategies<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token string">&quot;S&quot;</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> salary<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;A&quot;</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> salary<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;B&quot;</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> salary<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">//请求转接</span>
<span class="token keyword">var</span> <span class="token function-variable function">calcu</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter">level<span class="token punctuation">,</span>salary</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> strategies<span class="token punctuation">[</span>level<span class="token punctuation">]</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>跟计算奖金有关的逻辑不再放在Context中，而是分布在各个策略对象中</li> <li>Context并没有计算奖金的能力，而是把这个职责委托给某个策略对象</li> <li>每个策略对象负责的算法已被各自封装在对象内部</li></ul> <p>经典用法：使用策略模式实现缓动动画，表单</p> <p>简单来说：策略模式指的是定义一系列的算法，并且把他们封装起来</p> <h2 id="代理模式"><a href="#代理模式" aria-hidden="true" class="header-anchor">#</a> 代理模式</h2> <p>为一个对象提供一个代用品或占位符，以便控制对他的访问</p> <p>客户——代理（走一些处理）——本体</p> <h5 id="保护代理："><a href="#保护代理：" aria-hidden="true" class="header-anchor">#</a> 保护代理：</h5> <p>用于控制不同权限的对象对目标对象的访问</p> <h5 id="虚拟代理："><a href="#虚拟代理：" aria-hidden="true" class="header-anchor">#</a> 虚拟代理：</h5> <p>把一些开销很大的对象，延迟到真正需要他的时候采取创建（常用）</p> <p>eg：虚拟代理实现图片预加载</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> myImage<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">var</span> imgNode<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
   document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>imgNode<span class="token punctuation">)</span>
   <span class="token keyword">return</span> <span class="token punctuation">{</span>
       <span class="token function-variable function">setSrc</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           imgNode<span class="token punctuation">.</span>src<span class="token operator">=</span>src
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> proxyImage<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span>
   img<span class="token punctuation">.</span><span class="token function-variable function">onload</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> <span class="token punctuation">{</span>
       <span class="token function-variable function">setSrc</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token string">'file:// /C:loading.gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           img<span class="token punctuation">.</span>src<span class="token operator">=</span>src
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
proxyImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token string">'http://img.jpg'</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="缓存代理："><a href="#缓存代理：" aria-hidden="true" class="header-anchor">#</a> 缓存代理：</h5> <p>为一些开销大的运算结果提供暂时的存储，在下次运算时，如果传递进来的参数跟之前一致，则可以直接返回前面存储的运算结果</p> <p>eg：计算乘积</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//计算乘积的函数</span>
<span class="token keyword">var</span> <span class="token function-variable function">mult</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;开始计算乘积&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span><span class="token number">1</span> 
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token operator">=</span>arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>l<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        a<span class="token operator">=</span>a<span class="token operator">*</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> a
<span class="token punctuation">}</span>
<span class="token comment">//缓存函数</span>
<span class="token keyword">var</span> proxyMult <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> cache<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> args<span class="token operator">=</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args <span class="token keyword">in</span> cache<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">mult</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">proxyMult</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">proxyMult</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p>当第二次调用proxyMult(1,2)的时候，本体mult函数并没有被计算，proxyMult直接返回了之前缓存好的计算结果。</p> <p>缓存代理用于ajax异步请求数据</p> <p>项目中的分页需求，同一页的数据理论上只需要去后台拉取一次，这些已经拉取到的数据在某个地方被缓存之后，下次再请求同一页的时候，便可以直接使用之前的数据。</p> <h5 id="高阶函数动态创建代理"><a href="#高阶函数动态创建代理" aria-hidden="true" class="header-anchor">#</a> 高阶函数动态创建代理</h5> <p>eg：缓存代理为例</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">createProxyFactory</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> cache<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> args<span class="token operator">=</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args <span class="token keyword">in</span> cache<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="迭代器模式"><a href="#迭代器模式" aria-hidden="true" class="header-anchor">#</a> 迭代器模式</h2> <p>是指提供一种方法顺序访问一个聚合对象中的各个元素，而又不需要暴露该对象的内部表示。</p> <p>javascript中的forEach函数</p> <p>链接：https://pan.baidu.com/s/15DPohg1aYKE4v7jzUcTYRA
提取码：zw4r</p> <h2 id="发布订阅模式-观察者模式"><a href="#发布订阅模式-观察者模式" aria-hidden="true" class="header-anchor">#</a> 发布订阅模式-观察者模式</h2> <p>一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知</p> <ol><li>首先要指定好谁充当发布者</li> <li>然后给发布者添加一个缓存列表，用于存放回调函数以便通知订阅者</li> <li>最后发布消息的时候，发布者会遍历这个缓存列表，依次触发里面存放的订阅者回调函数</li></ol> <p>eg：售楼部</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> event<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token comment">//缓存列表，存放订阅者的回调函数</span>
    clientList<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function-variable function">listen</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//如果还没有订阅过此类消息，给该类消息创建一个缓存列表</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>clientList<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>clientList<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//订阅的消息添加进消息缓存列表</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>clientList<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//发布消息</span>
    <span class="token function-variable function">trigger</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//取出消息类型</span>
        <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
        <span class="token comment">//取出该消息对应的回调函数集合</span>
        <span class="token keyword">var</span> fns <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clientList<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token comment">//如果没有订阅该消息，则返回</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fns<span class="token operator">||</span>fns<span class="token punctuation">.</span>length<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>fn<span class="token punctuation">;</span>fn<span class="token operator">=</span>fns<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">remove</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> fns <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clientList<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>！fns<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fn<span class="token punctuation">)</span><span class="token punctuation">{</span>
            fns<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>fns<span class="token punctuation">.</span>length<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> l<span class="token operator">=</span>fns<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>l<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">;</span>l<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">var</span> _fn<span class="token operator">=</span>fns<span class="token punctuation">[</span>l<span class="token punctuation">]</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>_fn<span class="token operator">===</span>fn<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    fns<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">installEvent</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>event<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre></div><ul><li>时间上的解耦</li> <li>对象之间的解耦</li> <li>消耗内存</li> <li>若过度使用，如多个发布者和订阅者嵌套到一起的时候，难以追踪</li></ul> <h2 id="命令模式"><a href="#命令模式" aria-hidden="true" class="header-anchor">#</a> 命令模式</h2> <p>有时候需要向某些对象发送请求，但是并不知道请求的接收者是谁，也不知道被请求的操作是什么。此时希望用一种松耦合的方式来设计程序，使得请求发送者和请求接收者能够消除彼此之间的耦合关系。</p> <p>eg：订餐</p> <p>命令模式把客人订餐的请求封装成command对象，也就是订餐中的订单对象，这个对象可以在程序中被四处传递，就像订单可以从服务员手中传到厨师的手中。这样一来，客人不需要知道厨师的名字，从而解开了请求调用者和请求接收者之间的耦合关系。</p> <p>命令模式在JavaScript语言中是一种隐形的模式</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.0d710046.js" defer></script><script src="/blog/assets/js/2.3724615d.js" defer></script><script src="/blog/assets/js/9.39b50577.js" defer></script>
  </body>
</html>
